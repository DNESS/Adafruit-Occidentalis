#!/usr/bin/env bash

source /etc/adafruit-io-gif/server.conf

if [ "$1" == "start" ]; then

  echo "Starting GIF server..."

  forever start /etc/adafruit-io-gif/node_source/index.js &>/dev/null
  sleep 5
  nohup xinit /etc/adafruit-io-gif/xinit_script >/dev/null 2>&1 &

fi

if [ "$1" == "stop" ]; then

  echo "Stopping GIF server..."
  forever stop /etc/adafruit-io-gif/node_source/index.js &>/dev/null

  killall midori 2>/dev/null;
  killall matchbox-window-manager 2>/dev/null;

fi

if [ "$1" == "refresh" ]; then

  export DISPLAY

  xdotool getactivewindow
  xdotool key F5

fi

